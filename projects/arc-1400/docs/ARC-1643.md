# ARC-1643: Security Token Document Registry (Draft)

Status: Draft  
Category: Standard Track  
Created: 2025-09-03  
Part of: ARC-1400 Suite  
Author(s): <your-name / org>

## 1. Abstract

ARC-1643 standardizes on-chain references to off-chain documents (e.g., Offering Memorandum, Subscription Agreement, Financial Reports) tied to a security token implementation. Each document is stored as a record containing a name, URI, cryptographic hash, and timestamp to ensure integrity and auditability.

## 2. Motivation

Regulated assets require discoverable, tamper-evident links to disclosure documents. Ethereum's ERC-1643 provides a model; this ARC adapts it to Algorand using global state and boxes for scalable metadata while minimizing transaction costs and enabling rich indexing.

## 3. Specification

### 3.1 Document Record

Fields:

- `name: byte[]` (key)
- `uri: byte[]` (UTF-8; may be IPFS, HTTPS)
- `hash: byte[32]` (SHA-256 or multihash subset; implementers SHOULD clarify algorithm)
- `timestamp: uint64` (block round or Unix timestamp if oracle-supplied)
- `doc-type: uint64` (optional classification enum)

### 3.2 Storage

Each document stored in a box named `doc-<hashPrefix>` or `doc-<nameHash>`. A global index box `doc-index` maintains msgpack array of (name, hash) pairs for enumeration.

### 3.3 Methods (ABI Recommendations)

- `SetDocument(name:byte[], uri:byte[], hash:byte[32])`
- `GetDocument(name:byte[]) -> (uri:byte[], hash:byte[32], timestamp:uint64)`
- `DocumentHash(name:byte[]) -> (hash:byte[32])`
- `DocumentNames() -> (names:byte[][])` (may stream via pagination cursors)

`SetDocument` MUST overwrite existing and update index; timestamp set to current round unless provided by trusted oracle.

### 3.4 Events (Logs)

- Tag 0x21 DocumentSet | name | hash

### 3.5 Integrity

Clients SHOULD verify retrieved document content hash matches stored `hash`. URIs SHOULD support secure transport (HTTPS / IPFS). Multi-hash encoding MAY be used; if so, store canonical multihash bytes rather than raw digest.

### 3.6 Pagination (Optional)

If document count large, support `DocumentNamesPage(cursor:uint64, limit:uint64)`.

## 4. Security Considerations

- Only issuer/governance may set documents.
- Avoid storing sensitive document content on-chain; store only references + hash.
- Ensure name collisions are handled deterministically (overwrite or reject; this ARC chooses overwrite).

## 5. Backwards Compatibility

Can be integrated into an ARC-1400 unified application or standalone for general-purpose asset document registries.

## 6. Reference Implementation

See repository module `smart_contracts/security_token`.

## 7. Copyright

CC0 1.0 Universal.
