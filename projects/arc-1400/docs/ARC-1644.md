# ARC-1644: Controller Operations for Security Tokens (Draft)

Status: Draft  
Category: Standard Track  
Created: 2025-09-03  
Part of: ARC-1400 Suite  
Depends On: ARC-1594, ARC-1410  
Author(s): <your-name / org>

## 1. Abstract

ARC-1644 defines standardized controller powers for security tokens on Algorand, enabling forced transfers and redemptions under strictly governed conditions (e.g., court order, regulatory action, error remediation). It mirrors Ethereum's ERC-1644 while adapting privilege enforcement to Algorand's ARC-200 token control and smart contract mechanism.

## 2. Motivation

Certain regulated events necessitate administrative intervention. A predictable, auditable interface reduces systemic risk and ensures interoperability across custodians and secondary trading platforms.

## 3. Specification

### 3.1 Controller Authorization

Global state MUST store `controller` (address) OR a list of controllers in a box `controllers`. A multi-sig or logic signature is RECOMMENDED. Changes to controller set SHOULD be timelocked via `pending-controller` + `activate-round` pattern.

### 3.2 Required Methods (snake_case, ARC-4 types)

- `controller_transfer(from: address, to: address, partition: bytes32, amount: uint64, data: bytes, operator_data: bytes) -> (code: uint64)`
- `controller_redeem(from: address, partition: bytes32, amount: uint64, operator_data: bytes) -> (code: uint64)`
- `is_controllable() -> (flag: uint64)` returns 1 if controller functions enabled.
- `set_controller(new_controller: address)` (timelocked)
- `add_controller(addr: address)` / `remove_controller(addr: address)`

### 3.3 Semantics

Controller operations bypass standard sender consent but MUST still respect partition invariants and reason codes. Forced actions SHOULD emit logs referencing `operator_data` justification.

### 3.4 Execution Pattern

Implementation configures ARC-200 transfer authority such that only application-governed logic can perform forced movements (e.g., via a logic-controlled clawback equivalent or authority address). `controller_transfer` constructs an inner ARC-200 transfer `from -> to`. If using an external authority address, ensure it is rekeyed / restricted to contract governance.

### 3.5 Events (Logs)

- Tag 0x31 controller_transfer | from | to | partition | amount | code
- Tag 0x32 controller_redeem | from | partition | amount | code
- Tag 0x33 controller_changed | old | new

### 3.6 Reason Codes

Re-use ARC-1594 general codes; add:

- `50` ControllerUnauthorized
- `51` ControllerDisabled
- `52` JustificationRequired

### 3.7 Safeguards

- Mandatory justification: if global `require-just` == 1, `operator_data` MUST contain a non-empty explanation or legal reference identifier.
- Rate limiting (optional): store last controller action round; enforce minimum interval.
- Audit trail: append structured log with reason code + hashed justification docs.

### 3.8 Disabling Control

`is_controllable` may return 0 after a governance decision to renounce override powers. Implementation sets `controller` to zero-address and `controllable` = 0 (immutable).

## 4. Security Considerations

- Ensure controller cannot mint (that's issuance) unless explicitly allowed; separation of duties.
- Timelock controller changes to mitigate key compromise.
- Make justification transparent while avoiding sensitive full-text storage (hash large documents).

## 5. Backwards Compatibility

If not implemented, `is_controllable` MUST return 0 and controller methods MUST revert / reject with `51`.

## 6. Reference Implementation

Planned in `smart_contracts/security_token`.

## 7. Copyright

CC0 1.0 Universal.
