# ARC-1644: Controller Operations for Security Tokens (Draft)

Status: Draft  
Category: Standard Track  
Created: 2025-09-03  
Part of: ARC-1400 Suite  
Depends On: ARC-1594, ARC-1410  
Author(s): <your-name / org>

## 1. Abstract

ARC-1644 defines standardized controller powers for security tokens on Algorand, enabling forced transfers and redemptions under strictly governed conditions (e.g., court order, regulatory action, error remediation). It mirrors Ethereum's ERC-1644 while adapting privilege enforcement to Algorand's clawback and smart contract mechanism.

## 2. Motivation

Certain regulated events necessitate administrative intervention. A predictable, auditable interface reduces systemic risk and ensures interoperability across custodians and secondary trading platforms.

## 3. Specification

### 3.1 Controller Authorization

Global state MUST store `controller` (address) OR a list of controllers in a box `controllers`. A multi-sig or logic signature is RECOMMENDED. Changes to controller set SHOULD be timelocked via `pending-controller` + `activate-round` pattern.

### 3.2 Required Methods

- `ControllerTransfer(from, to, partition, amount, data:byte[], operator_data:byte[]) -> (code:uint64)`
- `ControllerRedeem(from, partition, amount, operator_data:byte[]) -> (code:uint64)`
- `IsControllable() -> (flag:uint64)` returns 1 if controller functions enabled.
- `SetController(newController)` (timelocked) or `AddController(addr)` / `RemoveController(addr)`.

### 3.3 Semantics

Controller operations bypass standard sender consent but MUST still respect partition invariants and reason codes. Forced actions SHOULD emit logs referencing operator_data justification.

### 3.4 Execution Pattern

Implementation uses clawback address (ASA configuration) controlled solely by the application logic (App address is clawback). `ControllerTransfer` constructs inner transaction: asset clawback transfer `from -> to`. If using external clawback address, ensure rekey to application or multisig controlling logic.

### 3.5 Events (Logs)

- Tag 0x31 ControllerTransfer | from | to | partition | amount | code
- Tag 0x32 ControllerRedeem | from | partition | amount | code
- Tag 0x33 ControllerChanged | old | new

### 3.6 Reason Codes

Re-use ARC-1594 general codes; add:

- `50` ControllerUnauthorized
- `51` ControllerDisabled
- `52` JustificationRequired

### 3.7 Safeguards

- Mandatory justification: if global `require-just` == 1, operator_data MUST contain a non-empty explanation or legal reference identifier.
- Rate limiting (optional): store last controller action round; enforce minimum interval.
- Audit trail: append structured log with reason code + hashed justification docs.

### 3.8 Disabling Control

`IsControllable` may return 0 after a governance decision to renounce override powers. Implementation sets `controller` to zero-address and `controllable` = 0 (immutable).

## 4. Security Considerations

- Ensure controller cannot mint (that's issuance) unless explicitly allowed; separation of duties.
- Timelock controller changes to mitigate key compromise.
- Make justification transparent while avoiding sensitive full-text storage (hash large documents).

## 5. Backwards Compatibility

If not implemented, `IsControllable` MUST return 0 and controller methods MUST revert / reject with `51`.

## 6. Reference Implementation

Planned in `smart_contracts/security_token`.

## 7. Copyright

CC0 1.0 Universal.
